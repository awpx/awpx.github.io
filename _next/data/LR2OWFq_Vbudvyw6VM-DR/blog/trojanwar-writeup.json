{"pageProps":{"post":{"mdxSource":"var Component=(()=>{var p=Object.create;var r=Object.defineProperty;var u=Object.getOwnPropertyDescriptor;var m=Object.getOwnPropertyNames;var g=Object.getPrototypeOf,f=Object.prototype.hasOwnProperty;var l=t=>r(t,\"__esModule\",{value:!0});var w=(t,n)=>()=>(n||t((n={exports:{}}).exports,n),n.exports),y=(t,n)=>{l(t);for(var a in n)r(t,a,{get:n[a],enumerable:!0})},b=(t,n,a)=>{if(n&&typeof n==\"object\"||typeof n==\"function\")for(let i of m(n))!f.call(t,i)&&i!==\"default\"&&r(t,i,{get:()=>n[i],enumerable:!(a=u(n,i))||a.enumerable});return t},k=t=>b(l(r(t!=null?p(g(t)):{},\"default\",t&&t.__esModule&&\"default\"in t?{get:()=>t.default,enumerable:!0}:{value:t,enumerable:!0})),t);var h=w((N,c)=>{c.exports=_jsx_runtime});var x={};y(x,{default:()=>I,frontmatter:()=>j});var e=k(h()),j={title:'[CTF Writeups] CTF \"Trojanwar\" Writeups ',date:new Date(1645385534e3),lastmod:\"2022-01-24\",tags:[\"ctf\",\"writeups\"],draft:!1,summary:\"This is a write up of a TrojanWar CTF challenge that i solved as part of assignment for the (C****ti IT Security Analyst - Red Team) recruitment process, which in the end I did not pass the interview stage\",layout:\"PostLayout\",authors:[\"default\"],canonicalUrl:\"https://awpx.github.io/blog/trojanwar-writeup\"};function v(t={}){let{wrapper:n}=t.components||{};return n?(0,e.jsx)(n,Object.assign({},t,{children:(0,e.jsx)(a,{})})):a();function a(){let i=Object.assign({h2:\"h2\",a:\"a\",span:\"span\",p:\"p\",ul:\"ul\",li:\"li\",pre:\"pre\",code:\"code\",strong:\"strong\",div:\"div\"},t.components),{TOCInline:o,Image:s}=i;return s||d(\"Image\",!0),o||d(\"TOCInline\",!0),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(o,{toc:t.toc,asDisclosure:!0}),(0,e.jsxs)(i.h2,{id:\"challenge-description\",children:[(0,e.jsx)(i.a,{\"aria-hidden\":\"true\",href:\"#challenge-description\",tabIndex:\"-1\",children:(0,e.jsx)(i.span,{className:\"icon icon-link\"})}),\"Challenge Description\"]}),(0,e.jsx)(i.p,{children:\"This is a write up of TrojanWar CTF challenge that i solved as part of assignment for the (C****ti IT Security Analyst - Red Team) recruitment process, which in the end I did not pass the interview stage, so this is my writeups.\"}),(0,e.jsx)(i.p,{children:\"For this challenge, I need to perform an attack on the TrojanWar VM and try to make my way to the flag located at /root/flag.txt.\"}),(0,e.jsxs)(i.h2,{id:\"step-1-deploying-the-machine\",children:[(0,e.jsx)(i.a,{\"aria-hidden\":\"true\",href:\"#step-1-deploying-the-machine\",tabIndex:\"-1\",children:(0,e.jsx)(i.span,{className:\"icon icon-link\"})}),\"Step 1: Deploying the machine\"]}),(0,e.jsx)(i.p,{children:\"Before we start doing anything, we have to deploy the target machine that already provided (TrojanWar.vmdk). For this, i'm using VMWare workstation player virtual machine to deploy the virtual disk. Wait until the machine finish booting, check ping, if it's ok then it means the machine is ready to be used.\"}),(0,e.jsx)(i.p,{children:\"Target machine information:\"}),(0,e.jsxs)(i.ul,{children:[(0,e.jsx)(i.li,{children:\"Target IP : 192.168.50.129\"}),(0,e.jsx)(i.li,{children:\"Target OS : Linux Ubuntu 18.04.6\"})]}),(0,e.jsxs)(i.h2,{id:\"step-2-reconenumeration\",children:[(0,e.jsx)(i.a,{\"aria-hidden\":\"true\",href:\"#step-2-reconenumeration\",tabIndex:\"-1\",children:(0,e.jsx)(i.span,{className:\"icon icon-link\"})}),\"Step 2: Recon/Enumeration\"]}),(0,e.jsx)(i.p,{children:\"In this section, we will be doing enumeration to gather more information on the machine by running scans with tools like Nmap and GoBuster.\"}),(0,e.jsx)(i.p,{children:\"First, I start with Nmap with simple command:\"}),(0,e.jsx)(i.pre,{className:\"language-bash\",children:(0,e.jsx)(i.code,{className:\"language-bash code-highlight\",children:(0,e.jsxs)(i.span,{className:\"code-line\",children:[\"awp@awp:~/pentest/ctf/cermati/trojanwar$ nmap -sC -sV \",(0,e.jsx)(i.span,{className:\"token number\",children:\"192.168\"}),`.50.129\n`]})})}),(0,e.jsx)(i.p,{children:\"From this scan, we can get more information about Target Open Port:.\"}),(0,e.jsxs)(i.ul,{children:[(0,e.jsx)(i.li,{children:\"Port 22 SSH (OpenSSH 7.6p1)\"}),(0,e.jsx)(i.li,{children:\"Port 80 HTTP (nginx 1.14, wordpress 5.8.3)\"})]}),(0,e.jsx)(i.p,{children:\"After we know that this machine running some website, we can check it. I try to check every post, maybe there is some hint in the code, but i found nothing suspicious.\"}),(0,e.jsx)(i.p,{children:\"My next step is brute-forcing web directories with Gobuster using simple wordlist:\"}),(0,e.jsx)(i.pre,{className:\"language-bash\",children:(0,e.jsx)(i.code,{className:\"language-bash code-highlight\",children:(0,e.jsx)(i.span,{className:\"code-line\",children:`awp@awp:~/pentest/ctf/cermati/trojanwar$ gobuster -u http://192.168.50.129 -w /home/awp/pentest/wordlists/common.txt\n`})})}),(0,e.jsxs)(i.p,{children:[\"I try to check all the directories that found in the scan, but i know and realize i miss some important directories. Then after several minutes doing some research about wordpress directory, I finally found something interesting in \",(0,e.jsx)(i.code,{children:\"/wp-ext\"}),\", possible vulnerability: \",(0,e.jsx)(i.strong,{children:\"File Upload Vulnerabilities\"}),\".\"]}),(0,e.jsx)(i.p,{children:\"File upload vulnerabilities are when a web server allows users/anonymous to upload files to its filesystem without sufficiently validating things like their name, type, contents, or size.\"}),(0,e.jsx)(i.div,{children:(0,e.jsx)(s,{alt:\"trojan2\",src:\"/static/images/trojanwar/trojan2.jpg\",width:\"769\",height:\"1156\"})}),(0,e.jsxs)(i.h2,{id:\"step-3-getting-a-shell\",children:[(0,e.jsx)(i.a,{\"aria-hidden\":\"true\",href:\"#step-3-getting-a-shell\",tabIndex:\"-1\",children:(0,e.jsx)(i.span,{className:\"icon icon-link\"})}),\"Step 3: Getting a shell\"]}),(0,e.jsxs)(i.p,{children:[\"I'm not sure how many possibilities/ways to get a shell on this machine, but i decide to use common \",(0,e.jsx)(i.strong,{children:\"php reverse shell\"}),\". I configure it with my ip and port 4444, named the file \",(0,e.jsx)(i.code,{children:\"test.php\"}),\", and try to upload it.\"]}),(0,e.jsxs)(i.p,{children:[\"The shell location is in \",(0,e.jsx)(i.code,{children:\"/var/www/wordpress/wp-ext/uploads/test.php\"})]}),(0,e.jsx)(i.p,{children:\"My first attempt was already successful, meaning that the website don\\u2019t use some file upload filtering at all. Plus, after the file has been uploaded successfully, the web send a response about the location of the file that we uploaded.\"}),(0,e.jsx)(i.p,{children:\"Now we just have to set up the listener and execute our shell.\"}),(0,e.jsx)(i.div,{children:(0,e.jsx)(s,{alt:\"trojan3\",src:\"/static/images/trojanwar/trojan3.jpg\",width:\"796\",height:\"625\"})}),(0,e.jsxs)(i.h2,{id:\"step-4-privilege-escalation\",children:[(0,e.jsx)(i.a,{\"aria-hidden\":\"true\",href:\"#step-4-privilege-escalation\",tabIndex:\"-1\",children:(0,e.jsx)(i.span,{className:\"icon icon-link\"})}),\"Step 4: Privilege Escalation\"]}),(0,e.jsxs)(i.p,{children:[\"To start the process, i try all the possibilities to use 'easy way' for privilege escalation, like check \",(0,e.jsx)(i.code,{children:\"sudo -l\"}),\", \",(0,e.jsx)(i.code,{children:\"SUID\"}),\", etc, but nothing work.\"]}),(0,e.jsx)(i.p,{children:\"I find that there are 3 user in this machine (hektor, helen, paris). I think i need to login to ssh using one of the three account, which is i believe that their credential is hidden but accessible somewhere in this machine.\"}),(0,e.jsxs)(i.p,{children:[\"After a few minutes of searching, I finally found a file that contain some credentials, to be exact in this file \",(0,e.jsx)(i.code,{children:\"/var/www/wordpress/wp-config.php\"}),\".\"]}),(0,e.jsxs)(i.p,{children:[\"One of users credential, \",(0,e.jsx)(i.code,{children:\"paris:hektor-socool\"})]}),(0,e.jsx)(i.p,{children:\"I tried login SSH using this account, and it worked!\"}),(0,e.jsxs)(i.p,{children:[\"For the second time, i try all the possibilities to use 'easy way' for privilege escalation, like check \",(0,e.jsx)(i.code,{children:\"sudo -l\"}),\", \",(0,e.jsx)(i.code,{children:\"SUID\"}),\", etc, still, i can't see the way.\"]}),(0,e.jsxs)(i.p,{children:[\"But fortunatelly, I found file that contain all mysql user account in \",(0,e.jsx)(i.code,{children:\"paris\"}),\" directory in \",(0,e.jsx)(i.code,{children:\".mysql_history\"}),\" file.\"]}),(0,e.jsxs)(i.p,{children:[\"All three user credential: \",(0,e.jsx)(i.code,{children:\"paris:hektor-socool, hektor:fuck-achilles, helen:spartasux-h0h0\"})]}),(0,e.jsx)(i.p,{children:\"I found that i can't login shh using hector's account credentials, but luckily i can login using helen's account.\"}),(0,e.jsxs)(i.p,{children:[\"Finally, the \",(0,e.jsx)(i.code,{children:\"sudo -l\"}),\" command give a good results. I can execute sudo for all file in \",(0,e.jsx)(i.code,{children:\"(root) /home/hektor/sysutils/*\"}),\" directories.\"]}),(0,e.jsxs)(i.p,{children:[\"This \",(0,e.jsx)(i.code,{children:\"admin-utils.sh\"}),\" file can make us become root when executed by authorized sudo user.\"]}),(0,e.jsx)(\"div\",{className:\"remark-code-title\",children:\"admin-utils.sh\"}),(0,e.jsx)(i.pre,{className:\"language-bash\",children:(0,e.jsxs)(i.code,{className:\"language-bash code-highlight\",children:[(0,e.jsxs)(i.span,{className:\"code-line\",children:[(0,e.jsx)(i.span,{className:\"token important shebang\",children:\"#!/bin/bash\"}),`\n`]}),(0,e.jsx)(i.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(i.span,{className:\"code-line\",children:[(0,e.jsx)(i.span,{className:\"token function\",children:\"sudo\"}),\" \",(0,e.jsx)(i.span,{className:\"token function\",children:\"su\"}),`\n`]})]})}),(0,e.jsxs)(i.p,{children:[\"With that file, i can easily get the root access by just execute \",(0,e.jsx)(i.code,{children:\"sudo ./admin-utils.sh\"}),\".\"]}),(0,e.jsx)(i.div,{children:(0,e.jsx)(s,{alt:\"trojan4\",src:\"/static/images/trojanwar/trojan4.jpg\",width:\"670\",height:\"783\"})}),(0,e.jsxs)(i.h2,{id:\"step-5-capture-the-flag\",children:[(0,e.jsx)(i.a,{\"aria-hidden\":\"true\",href:\"#step-5-capture-the-flag\",tabIndex:\"-1\",children:(0,e.jsx)(i.span,{className:\"icon icon-link\"})}),\"Step 5: Capture The Flag!\"]}),(0,e.jsx)(i.p,{children:\"And here is the Flag!\"}),(0,e.jsx)(i.div,{children:(0,e.jsx)(s,{alt:\"trojan5\",src:\"/static/images/trojanwar/trojan5.jpg\",width:\"681\",height:\"610\"})}),(0,e.jsxs)(i.h2,{id:\"summary\",children:[(0,e.jsx)(i.a,{\"aria-hidden\":\"true\",href:\"#summary\",tabIndex:\"-1\",children:(0,e.jsx)(i.span,{className:\"icon icon-link\"})}),\"Summary\"]}),(0,e.jsx)(i.p,{children:\"This was a nice and fun CTF Challenge that touches on a lot of fundamentals. For the privilege escalation section, i could use automation tools such as linpeas or linenum, but i don't use them because this challenge is not limited by time and is not categorized as a hard challenge so i can take my time doing enumeration/gathering information manually.\"}),(0,e.jsx)(i.p,{children:\"I really enjoy and excited doing this CTFs and I think that this is a great way to to learn, test, or recall the cyber security skills that we have learned, so thanks for this opportunities and I hope this writeup can be useful.\"}),(0,e.jsx)(i.p,{children:\"Thank you :)\"})]})}}var I=v;function d(t,n){throw new Error(\"Expected \"+(n?\"component\":\"object\")+\" `\"+t+\"` to be defined: you likely forgot to import, pass, or provide it.\")}return x;})();\n;return Component;","toc":[{"value":"Challenge Description","url":"#challenge-description","depth":2},{"value":"Step 1: Deploying the machine","url":"#step-1-deploying-the-machine","depth":2},{"value":"Step 2: Recon/Enumeration","url":"#step-2-reconenumeration","depth":2},{"value":"Step 3: Getting a shell","url":"#step-3-getting-a-shell","depth":2},{"value":"Step 4: Privilege Escalation","url":"#step-4-privilege-escalation","depth":2},{"value":"Step 5: Capture The Flag!","url":"#step-5-capture-the-flag","depth":2},{"value":"Summary","url":"#summary","depth":2}],"frontMatter":{"readingTime":{"text":"5 min read","minutes":4.22,"time":253200,"words":844},"slug":"trojanwar-writeup","fileName":"trojanwar-writeup.mdx","title":"[CTF Writeups] CTF \"Trojanwar\" Writeups ","date":"2022-02-20T19:32:14.000Z","lastmod":"2022-01-24","tags":["ctf","writeups"],"draft":false,"summary":"This is a write up of a TrojanWar CTF challenge that i solved as part of assignment for the (C****ti IT Security Analyst - Red Team) recruitment process, which in the end I did not pass the interview stage","layout":"PostLayout","authors":["default"],"canonicalUrl":"https://awpx.github.io/blog/trojanwar-writeup"}},"authorDetails":[{"readingTime":{"text":"3 min read","minutes":2.82,"time":169200,"words":564},"slug":["default"],"fileName":"default.md","name":"Andika Wijaya Putra","avatar":"/static/images/avatar1.png","occupation":"IT Developer & Security Researcher","email":"awpxwork@gmail.com","twitter":"https://twitter.com/awpx_","linkedin":"https://www.linkedin.com/in/awpx","github":"https://github.com/awpx","date":null}],"prev":{"title":"Guide","date":"2022-01-22T15:32:14.000Z","lastmod":"2022-01-23","tags":["guide","mdx"],"draft":false,"summary":"An overview of the blog features & guide to use","layout":"PostLayout","authors":["default","anonim"],"bibliography":"references-data.bib","canonicalUrl":"https://awpx.github.io/blog/guide","slug":"guide"},"next":{"title":"[VULN/BUG] About Business Logic Error","date":"2022-02-26T21:44:14.000Z","lastmod":"2022-02-26","tags":["vuln","bug"],"draft":false,"summary":"Summary of innformation about \"Business Logic Error\" bugs","layout":"PostLayout","authors":["default"],"canonicalUrl":"https://awpx.github.io/blog/business-logic-error","slug":"business-logic-error"}},"__N_SSG":true}